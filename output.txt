Running Start

> doc-writer@1.0.0 start /opt/doc-executor
> NODE_PATH=app/src node app/index.js

{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Initializing doc-executor","time":"2018-10-16T17:17:25.086Z","src":{"file":"/opt/doc-executor/app/src/app.js","line":3},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connecting to queue DOC-STATUS","time":"2018-10-16T17:17:25.158Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":13,"func":"StatusQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connecting to queue DOC-DATA","time":"2018-10-16T17:17:25.616Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":17,"func":"DataQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connecting to queue DOC-EXECUTOR-TASKS","time":"2018-10-16T17:17:25.852Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":20,"func":"ExecutorQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T17:17:25.920Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":16,"func":"StatusQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T17:17:25.921Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":20,"func":"DataQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":" [*] Waiting for messages in DOC-EXECUTOR-TASKS","time":"2018-10-16T17:17:25.921Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":40,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T17:17:25.921Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":23,"func":"ExecutorQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Message received {\"id\":\"64a24887-0561-4c03-960e-5cf76cefcdac\",\"type\":\"EXECUTION_CREATE\",\"taskId\":\"910e5275-45d9-40cd-88e5-2bd084364579\",\"datasetId\":\"afa19fcf-0d1a-4ac6-ae3d-82a5ef8eeaf3\",\"fileUrl\":\"https://www.apihighways.org/static/hxl.csv\",\"provider\":\"csv\",\"legend\":{\"nested\":[],\"country\":[],\"region\":[],\"date\":[]},\"verified\":false,\"dataPath\":null}","time":"2018-10-16T17:18:15.684Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"message content { id: '64a24887-0561-4c03-960e-5cf76cefcdac',\n  type: 'EXECUTION_CREATE',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579',\n  datasetId: 'afa19fcf-0d1a-4ac6-ae3d-82a5ef8eeaf3',\n  fileUrl: 'https://www.apihighways.org/static/hxl.csv',\n  provider: 'csv',\n  legend: { nested: [], country: [], region: [], date: [] },\n  verified: false,\n  dataPath: null }","time":"2018-10-16T17:18:15.685Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Create task","time":"2018-10-16T17:18:15.685Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":60,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Creating index","time":"2018-10-16T17:18:15.685Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":61,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Creating index index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685 and type type in elastic","time":"2018-10-16T17:18:15.685Z","src":{"file":"/opt/doc-executor/app/src/services/elastic.service.js","line":54,"func":"createIndex"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending index created message of taskId 910e5275-45d9-40cd-88e5-2bd084364579 and index index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685","time":"2018-10-16T17:18:17.150Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":56,"func":"sendIndexCreated"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Sending message IndexCreatedMessage {\n  id: '49500870-9886-49c4-9c22-5aa65f8b2c8f',\n  type: 'STATUS_INDEX_CREATED',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579',\n  index: 'index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685' }","time":"2018-10-16T17:18:19.152Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Starting importing service","time":"2018-10-16T17:18:19.155Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":69,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Starting read file","time":"2018-10-16T17:18:19.156Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":52,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Getting converter of type csv and dataPath null and url https://www.apihighways.org/static/hxl.csv","time":"2018-10-16T17:18:19.156Z","src":{"file":"/opt/doc-executor/app/src/services/converters/converterFactory.js","line":10,"func":"getInstance"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Is a url. Downloading file","time":"2018-10-16T17:18:19.156Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":28,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Checking if the url https://www.apihighways.org/static/hxl.csv exists","time":"2018-10-16T17:18:19.157Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":53,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Headers  text/csv; charset=UTF-8 200","time":"2018-10-16T17:18:19.377Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":60,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Downloading....","time":"2018-10-16T17:18:19.377Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":70,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Temporal path /tmp/F530y6fmZtXewYP0b8KLVy2lMuqJvGr4.csv . Downloading","time":"2018-10-16T17:18:19.378Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":72,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending request","time":"2018-10-16T17:18:19.378Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":31},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"File size: 1.5 KiB","time":"2018-10-16T17:18:19.405Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":35,"func":"download.then.data"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Downloaded file!!!","time":"2018-10-16T17:18:19.406Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":74,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Second filepath","time":"2018-10-16T17:18:19.408Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":55,"func":"serialize"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"/tmp/F530y6fmZtXewYP0b8KLVy2lMuqJvGr4.csv","time":"2018-10-16T17:18:19.408Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":56,"func":"serialize"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Starting process file","time":"2018-10-16T17:18:19.408Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":62,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"skip row - has hashes","time":"2018-10-16T17:18:19.413Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":187,"func":"processRow"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Removing file /tmp/F530y6fmZtXewYP0b8KLVy2lMuqJvGr4.csv","time":"2018-10-16T17:18:19.415Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":63,"func":"readStream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Body data: 24","time":"2018-10-16T17:18:19.415Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":69,"func":"stream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Finishing reading file","time":"2018-10-16T17:18:19.415Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":75,"func":"stream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending data message (24)","time":"2018-10-16T17:18:19.416Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":57,"func":"sendDataMessage"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Sending message","time":"2018-10-16T17:18:21.419Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":39,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending Read data of taskId 910e5275-45d9-40cd-88e5-2bd084364579","time":"2018-10-16T17:18:21.421Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":72,"func":"sendReadData"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Sending message ReadDataMessage {\n  id: 'bac9ac8f-d15a-4fd9-8141-7c207a3c55c3',\n  type: 'STATUS_READ_DATA',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579' }","time":"2018-10-16T17:18:23.421Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Pack saved successfully, num: 1","time":"2018-10-16T17:18:23.422Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":81,"func":"dataQueueService.sendDataMessage.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending read file message","time":"2018-10-16T17:18:23.422Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":73,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending Read File of taskId 910e5275-45d9-40cd-88e5-2bd084364579","time":"2018-10-16T17:18:23.423Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":79,"func":"sendReadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Sending message ReadFileMessage {\n  id: '0f69cd49-34b8-4a20-bfde-7d3279c13e87',\n  type: 'STATUS_READ_FILE',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579' }","time":"2018-10-16T17:18:25.426Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Message processed successfully","time":"2018-10-16T17:18:25.427Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":71,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Message received {\"id\":\"a810d0d9-389f-4a81-9611-212aeb655307\",\"type\":\"EXECUTION_CONFIRM_IMPORT\",\"taskId\":\"910e5275-45d9-40cd-88e5-2bd084364579\",\"index\":\"index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685\"}","time":"2018-10-16T17:18:25.440Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"message content { id: 'a810d0d9-389f-4a81-9611-212aeb655307',\n  type: 'EXECUTION_CONFIRM_IMPORT',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579',\n  index: 'index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685' }","time":"2018-10-16T17:18:25.440Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Confirming index index_afa19fcf0d1a4ac6ae3d82a5ef8eeaf3_1539710295685","time":"2018-10-16T17:18:25.440Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":167,"func":"confirmImport"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":20,"msg":"Sending Read File of taskId 910e5275-45d9-40cd-88e5-2bd084364579","time":"2018-10-16T17:18:25.854Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":86,"func":"sendImportConfirmed"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Sending message ImportConfirmedMessage {\n  id: 'b6ea950f-1615-435c-becd-f374316de4b1',\n  type: 'STATUS_IMPORT_CONFIRMED',\n  taskId: '910e5275-45d9-40cd-88e5-2bd084364579',\n  lastCheckedDate: 2018-10-16T17:18:25.854Z }","time":"2018-10-16T17:18:27.855Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-957c7cd6d-g7knp","pid":16,"level":30,"msg":"Message processed successfully","time":"2018-10-16T17:18:27.857Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":71,"func":"consume"},"v":0}
