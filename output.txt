Running Start

> doc-writer@1.0.0 start /opt/doc-executor
> NODE_PATH=app/src node app/index.js

{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Initializing doc-executor","time":"2018-10-15T18:33:28.020Z","src":{"file":"/opt/doc-executor/app/src/app.js","line":3},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connecting to queue DOC-STATUS","time":"2018-10-15T18:33:28.089Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":13,"func":"StatusQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connecting to queue DOC-DATA","time":"2018-10-15T18:33:28.418Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":17,"func":"DataQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connecting to queue DOC-EXECUTOR-TASKS","time":"2018-10-15T18:33:28.642Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":20,"func":"ExecutorQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connected","time":"2018-10-15T18:33:28.707Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":20,"func":"DataQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connected","time":"2018-10-15T18:33:28.708Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":16,"func":"StatusQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":" [*] Waiting for messages in DOC-EXECUTOR-TASKS","time":"2018-10-15T18:33:28.709Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":40,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Connected","time":"2018-10-15T18:33:28.709Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":23,"func":"ExecutorQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Message received {\"id\":\"5700292b-37fb-498f-9e9f-4d8b0332f1a6\",\"type\":\"EXECUTION_CREATE\",\"taskId\":\"bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1\",\"datasetId\":\"694b4bb5-e474-4036-83f5-222c5d857be3\",\"fileUrl\":\"https://www.apihighways.org/static/hxl.csv\",\"provider\":\"csv\",\"legend\":{\"nested\":[],\"country\":[],\"region\":[],\"date\":[]},\"verified\":false,\"dataPath\":null}","time":"2018-10-15T18:37:41.486Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"message content { id: '5700292b-37fb-498f-9e9f-4d8b0332f1a6',\n  type: 'EXECUTION_CREATE',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1',\n  datasetId: '694b4bb5-e474-4036-83f5-222c5d857be3',\n  fileUrl: 'https://www.apihighways.org/static/hxl.csv',\n  provider: 'csv',\n  legend: { nested: [], country: [], region: [], date: [] },\n  verified: false,\n  dataPath: null }","time":"2018-10-15T18:37:41.486Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Create task","time":"2018-10-15T18:37:41.487Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":60,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Creating index","time":"2018-10-15T18:37:41.487Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":61,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Creating index index_694b4bb5e474403683f5222c5d857be3_1539628661487 and type type in elastic","time":"2018-10-15T18:37:41.487Z","src":{"file":"/opt/doc-executor/app/src/services/elastic.service.js","line":54,"func":"createIndex"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending index created message of taskId bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1 and index index_694b4bb5e474403683f5222c5d857be3_1539628661487","time":"2018-10-15T18:37:42.555Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":56,"func":"sendIndexCreated"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Sending message IndexCreatedMessage {\n  id: 'f352ba75-6eb0-4797-b8b4-07ac6d76ab6b',\n  type: 'STATUS_INDEX_CREATED',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1',\n  index: 'index_694b4bb5e474403683f5222c5d857be3_1539628661487' }","time":"2018-10-15T18:37:44.557Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Starting importing service","time":"2018-10-15T18:37:44.560Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":69,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Starting read file","time":"2018-10-15T18:37:44.561Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":52,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Getting converter of type csv and dataPath null and url https://www.apihighways.org/static/hxl.csv","time":"2018-10-15T18:37:44.561Z","src":{"file":"/opt/doc-executor/app/src/services/converters/converterFactory.js","line":10,"func":"getInstance"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Is a url. Downloading file","time":"2018-10-15T18:37:44.561Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":26,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Checking if the url https://www.apihighways.org/static/hxl.csv exists","time":"2018-10-15T18:37:44.562Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":53,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Headers  text/csv; charset=UTF-8 200","time":"2018-10-15T18:37:44.710Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":60,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Downloading....","time":"2018-10-15T18:37:44.711Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":70,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Temporal path /tmp/hYaDTOB8tkQrW94AQky30O7MqchPj9bl.csv . Downloading","time":"2018-10-15T18:37:44.711Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":72,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending request","time":"2018-10-15T18:37:44.711Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":31},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"File size: 17.8 KiB","time":"2018-10-15T18:37:44.739Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":35,"func":"download.then.data"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Downloaded file!!!","time":"2018-10-15T18:37:44.739Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":74,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Starting process file","time":"2018-10-15T18:37:44.741Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":62,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Removing file /tmp/hYaDTOB8tkQrW94AQky30O7MqchPj9bl.csv","time":"2018-10-15T18:37:44.757Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":55,"func":"readStream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Body data: 302","time":"2018-10-15T18:37:44.757Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":69,"func":"stream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Finishing reading file","time":"2018-10-15T18:37:44.757Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":75,"func":"stream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"colDataTypes: []","time":"2018-10-15T18:37:44.758Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":122,"func":"checkColumnDataTypes"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"first row: { index: \n   { _index: 'index_694b4bb5e474403683f5222c5d857be3_1539628661487',\n     _type: 'type' } }","time":"2018-10-15T18:37:44.758Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":123,"func":"checkColumnDataTypes"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending data message (302)","time":"2018-10-15T18:37:44.758Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":57,"func":"sendDataMessage"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Sending message","time":"2018-10-15T18:37:46.760Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":39,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending Read data of taskId bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1","time":"2018-10-15T18:37:46.763Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":72,"func":"sendReadData"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Sending message ReadDataMessage {\n  id: 'fd7ed5f4-1fdd-47dd-ba07-2c8d7b401df6',\n  type: 'STATUS_READ_DATA',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1' }","time":"2018-10-15T18:37:48.765Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Pack saved successfully, num: 1","time":"2018-10-15T18:37:48.766Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":81,"func":"dataQueueService.sendDataMessage.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending read file message","time":"2018-10-15T18:37:48.766Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":73,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending Read File of taskId bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1","time":"2018-10-15T18:37:48.766Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":79,"func":"sendReadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Sending message ReadFileMessage {\n  id: '1a8d95b1-6432-4688-915b-0c2b6becef7f',\n  type: 'STATUS_READ_FILE',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1' }","time":"2018-10-15T18:37:50.768Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Message processed successfully","time":"2018-10-15T18:37:50.770Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":71,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Message received {\"id\":\"87e418b5-d7bd-4d9b-8444-5f6a3ac0c10a\",\"type\":\"EXECUTION_CONFIRM_IMPORT\",\"taskId\":\"bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1\",\"index\":\"index_694b4bb5e474403683f5222c5d857be3_1539628661487\"}","time":"2018-10-15T18:37:50.780Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"message content { id: '87e418b5-d7bd-4d9b-8444-5f6a3ac0c10a',\n  type: 'EXECUTION_CONFIRM_IMPORT',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1',\n  index: 'index_694b4bb5e474403683f5222c5d857be3_1539628661487' }","time":"2018-10-15T18:37:50.780Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Confirming index index_694b4bb5e474403683f5222c5d857be3_1539628661487","time":"2018-10-15T18:37:50.780Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":167,"func":"confirmImport"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":20,"msg":"Sending Read File of taskId bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1","time":"2018-10-15T18:37:51.154Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":86,"func":"sendImportConfirmed"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Sending message ImportConfirmedMessage {\n  id: '25a777c6-c047-419b-b65b-320d4d3ad36e',\n  type: 'STATUS_IMPORT_CONFIRMED',\n  taskId: 'bef03ba7-ace7-4cdf-a9b7-8bcd4ab3e8a1',\n  lastCheckedDate: 2018-10-15T18:37:51.154Z }","time":"2018-10-15T18:37:53.156Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-6dc47f8945-f669n","pid":16,"level":30,"msg":"Message processed successfully","time":"2018-10-15T18:37:53.157Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":71,"func":"consume"},"v":0}
