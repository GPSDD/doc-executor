Running Start

> doc-writer@1.0.0 start /opt/doc-executor
> NODE_PATH=app/src node app/index.js

{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Initializing doc-executor","time":"2018-10-16T18:39:08.030Z","src":{"file":"/opt/doc-executor/app/src/app.js","line":3},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connecting to queue DOC-STATUS","time":"2018-10-16T18:39:08.099Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":13,"func":"StatusQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connecting to queue DOC-DATA","time":"2018-10-16T18:39:08.441Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":17,"func":"DataQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connecting to queue DOC-EXECUTOR-TASKS","time":"2018-10-16T18:39:08.667Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":20,"func":"ExecutorQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T18:39:08.739Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":20,"func":"DataQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T18:39:08.739Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":16,"func":"StatusQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":" [*] Waiting for messages in DOC-EXECUTOR-TASKS","time":"2018-10-16T18:39:08.741Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":40,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Connected","time":"2018-10-16T18:39:08.741Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":23,"func":"ExecutorQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Message received {\"id\":\"bbd45571-421d-4154-a42a-7c86b74dbb2c\",\"type\":\"EXECUTION_CREATE\",\"taskId\":\"9bf8acb3-08ca-4577-b4f9-cc6f56154b75\",\"datasetId\":\"d84a5519-3492-4aa5-aece-cd0a2309c806\",\"fileUrl\":\"https://www.apihighways.org/static/hxl.csv\",\"provider\":\"csv\",\"legend\":{\"nested\":[],\"country\":[],\"region\":[],\"date\":[]},\"verified\":false,\"dataPath\":null}","time":"2018-10-16T18:39:08.744Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"message content { id: 'bbd45571-421d-4154-a42a-7c86b74dbb2c',\n  type: 'EXECUTION_CREATE',\n  taskId: '9bf8acb3-08ca-4577-b4f9-cc6f56154b75',\n  datasetId: 'd84a5519-3492-4aa5-aece-cd0a2309c806',\n  fileUrl: 'https://www.apihighways.org/static/hxl.csv',\n  provider: 'csv',\n  legend: { nested: [], country: [], region: [], date: [] },\n  verified: false,\n  dataPath: null }","time":"2018-10-16T18:39:08.744Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Create task","time":"2018-10-16T18:39:08.744Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":60,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Creating index","time":"2018-10-16T18:39:08.744Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":61,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Creating index index_d84a551934924aa5aececd0a2309c806_1539715148745 and type type in elastic","time":"2018-10-16T18:39:08.745Z","src":{"file":"/opt/doc-executor/app/src/services/elastic.service.js","line":54,"func":"createIndex"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Sending index created message of taskId 9bf8acb3-08ca-4577-b4f9-cc6f56154b75 and index index_d84a551934924aa5aececd0a2309c806_1539715148745","time":"2018-10-16T18:39:10.128Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":56,"func":"sendIndexCreated"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Sending message IndexCreatedMessage {\n  id: 'd5e5baaf-1fa4-4282-8e88-6a32a060e98a',\n  type: 'STATUS_INDEX_CREATED',\n  taskId: '9bf8acb3-08ca-4577-b4f9-cc6f56154b75',\n  index: 'index_d84a551934924aa5aececd0a2309c806_1539715148745' }","time":"2018-10-16T18:39:12.131Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Starting importing service","time":"2018-10-16T18:39:12.134Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":69,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Starting read file","time":"2018-10-16T18:39:12.134Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":52,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Getting converter of type csv and dataPath null and url https://www.apihighways.org/static/hxl.csv","time":"2018-10-16T18:39:12.135Z","src":{"file":"/opt/doc-executor/app/src/services/converters/converterFactory.js","line":10,"func":"getInstance"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Is a url. Downloading file","time":"2018-10-16T18:39:12.135Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":28,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"Checking if the url https://www.apihighways.org/static/hxl.csv exists","time":"2018-10-16T18:39:12.135Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":53,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Headers  text/csv; charset=UTF-8 200","time":"2018-10-16T18:39:12.174Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":60,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Downloading....","time":"2018-10-16T18:39:12.175Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":70,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Temporal path /tmp/Nju1J9Ef8nvyqaWGgSCq5itYgAN2bTUs.csv . Downloading","time":"2018-10-16T18:39:12.175Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":72,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Sending request","time":"2018-10-16T18:39:12.176Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":31},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":30,"msg":"File size: 1.5 KiB","time":"2018-10-16T18:39:12.204Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":35,"func":"download.then.data"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"Downloaded file!!!","time":"2018-10-16T18:39:12.205Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":74,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"[ '#country+name',\n  '#activity+appeal+id+fts_internal',\n  '#activity+appeal+name',\n  '#activity+appeal+id+external',\n  '#date+start',\n  '#date+end',\n  '#date+year',\n  '#value+funding+required+usd',\n  '#value+funding+total+usd',\n  '#value+funding+pct' ]","time":"2018-10-16T18:39:12.210Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":84,"func":"readStream.on"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"formatted Second filepath","time":"2018-10-16T18:39:12.211Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":54,"func":"serialize"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-5fb75b96b8-wqxch","pid":16,"level":20,"msg":"/tmp/Nju1J9Ef8nvyqaWGgSCq5itYgAN2bTUs.csv","time":"2018-10-16T18:39:12.211Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":55,"func":"serialize"},"v":0}
